<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Concierge Widget Demo</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Lucide Icons (Global) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* Custom Animations */
        @keyframes wave {

            0%,
            100% {
                height: 40%;
                opacity: 0.5;
            }

            50% {
                height: 100%;
                opacity: 1;
            }
        }

        @keyframes pulse-border {
            0% {
                box-shadow: 0 0 0 0 rgba(var(--pulse-color), 0.7);
            }

            70% {
                box-shadow: 0 0 0 15px rgba(var(--pulse-color), 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(var(--pulse-color), 0);
            }
        }

        .animate-fade-in-right {
            animation: fadeInRight 0.4s ease-out forwards;
        }

        @keyframes fadeInRight {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.3s ease-out forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }

        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>

<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONS MAPPING ---
        // Исправлено: все иконки с множественными путями обернуты в фрагмент <></>

        const IconWrapper = ({ name, size = 24, className = "", ...props }) => {
            const icons = {
                X: <path d="M18 6 6 18M6 6 18 18" />,
                Mic: <><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" /><path d="M19 10v2a7 7 0 0 1-14 0v-2" /><line x1="12" x2="12" y1="19" y2="22" /><line x1="8" x2="16" y1="22" y2="22" /></>,
                PhoneOff: <><path d="M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91" /><line x1="23" x2="1" y1="1" y2="23" /></>,
                Sparkles: <><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z" /><path d="M5 3v4" /><path d="M9 3v4" /><path d="M3 5h4" /><path d="M3 9h4" /></>,
                Check: <path d="M20 6 9 17l-5-5" />,
                ChevronRight: <path d="m9 18 6-6-6-6" />,
                Headphones: <><path d="M3 14v3a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2Z" /><path d="M15 14v3a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2Z" /><path d="M5 9v11" /><path d="M19 9v11" /><path d="M5 9a7 7 0 0 1 14 0" /></>,
                Settings: <><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1-1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" /><circle cx="12" cy="12" r="3" /></>,
                Globe: <><circle cx="12" cy="12" r="10" /><path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20" /><path d="M2 12h20" /></>,
                MessageSquare: <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />,
                Palette: <><circle cx="13.5" cy="6.5" r=".5" /><circle cx="17.5" cy="10.5" r=".5" /><circle cx="8.5" cy="7.5" r=".5" /><circle cx="6.5" cy="12.5" r=".5" /><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z" /></>,
                Upload: <><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" /><polyline points="17 8 12 3 7 8" /><line x1="12" x2="12" y1="3" y2="15" /></>,
                Building2: <><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z" /><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2" /><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2" /><path d="M10 6h4" /><path d="M10 10h4" /><path d="M10 14h4" /><path d="M10 18h4" /></>,
                Link: <><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" /><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" /></>,
                Moon: <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z" />,
                Sun: <><circle cx="12" cy="12" r="4" /><path d="M12 2v2" /><path d="M12 20v2" /><path d="m4.93 4.93 1.41 1.41" /><path d="m17.66 17.66 1.41 1.41" /><path d="M2 12h2" /><path d="M20 12h2" /><path d="m6.34 17.66-1.41 1.41" /><path d="m19.07 4.93-1.41 1.41" /></>,
                Star: <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" />,
                Activity: <path d="M22 12h-4l-3 9L9 3l-3 9H2" />,
                AlignLeft: <><line x1="21" x2="3" y1="6" y2="6" /><line x1="15" x2="3" y1="12" y2="12" /><line x1="17" x2="3" y1="18" y2="18" /></>,
                AlignCenter: <><line x1="21" x2="3" y1="6" y2="6" /><line x1="17" x2="7" y1="12" y2="12" /><line x1="19" x2="5" y1="18" y2="18" /></>,
                AlignRight: <><line x1="21" x2="3" y1="6" y2="6" /><line x1="21" x2="9" y1="12" y2="12" /><line x1="21" x2="7" y1="18" y2="18" /></>,
                MoveHorizontal: <><polyline points="18 8 22 12 18 16" /><polyline points="6 8 2 12 6 16" /><line x1="2" x2="22" y1="12" y2="12" /></>,
                MoveVertical: <><polyline points="8 18 12 22 16 18" /><polyline points="8 6 12 2 16 6" /><line x1="12" x2="12" y1="2" y2="22" /></>
            };

            return (
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width={size}
                    height={size}
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    strokeWidth="2"
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    className={className}
                    {...props}
                >
                    {icons[name]}
                </svg>
            );
        };

        // --- COMPONENTS ---

        const THEME_MODES = {
            dark: {
                id: 'dark',
                bg: 'bg-slate-900',
                text: 'text-white',
                subtext: 'text-slate-400',
                border: 'border-white/10',
                inputBg: 'bg-white/5',
                buttonBg: 'bg-white/10 hover:bg-white/20',
                shadow: 'shadow-2xl',
                activeBorderBase: 'ring-2 ring-offset-2 ring-offset-slate-900',
            },
            light: {
                id: 'light',
                bg: 'bg-white',
                text: 'text-slate-900',
                subtext: 'text-slate-500',
                border: 'border-slate-200',
                inputBg: 'bg-slate-50',
                buttonBg: 'bg-slate-100 hover:bg-slate-200',
                shadow: 'shadow-xl',
                activeBorderBase: 'ring-2 ring-offset-2 ring-offset-white',
            }
        };

        const TEXT_VARIATIONS = {
            ru: {
                label: "Русский",
                variants: [
                    {
                        id: 'formal',
                        name: 'Официальный',
                        greeting: '',
                        button: 'Начать разговор',
                        connecting: 'Подключение...',
                        listening: '',
                        end: 'Закончить',
                        title: 'Консьерж',
                        tooltip: 'Привет! Я Феликс :) Чем могу помочь?'
                    },
                ]
            },
            en: {
                label: "English",
                variants: [
                    {
                        id: 'formal',
                        name: 'Formal',
                        greeting: '',
                        button: 'Start Conversation',
                        connecting: 'Connecting...',
                        listening: '',
                        end: 'End Call',
                        title: 'Concierge',
                        tooltip: 'Hi! I am Felix :) How can I help you?'
                    },
                ]
            }
        };

        const COLOR_THEMES = [
            { id: 'gold', name: 'Gold Luxury', primary: 'from-amber-400 to-yellow-600', glow: 'bg-amber-400', text: 'text-amber-600', accent: 'bg-amber-400', ring: 'ring-amber-400', rgb: '251, 191, 36' },
            { id: 'blue', name: 'Deep Ocean', primary: 'from-blue-500 to-indigo-600', glow: 'bg-blue-400', text: 'text-blue-600', accent: 'bg-blue-400', ring: 'ring-blue-400', rgb: '96, 165, 250' },
            { id: 'emerald', name: 'Nature Green', primary: 'from-emerald-400 to-teal-600', glow: 'bg-emerald-400', text: 'text-emerald-600', accent: 'bg-emerald-400', ring: 'ring-emerald-400', rgb: '52, 211, 153' },
            { id: 'purple', name: 'Royal Velvet', primary: 'from-purple-500 to-fuchsia-600', glow: 'bg-fuchsia-400', text: 'text-purple-600', accent: 'bg-fuchsia-400', ring: 'ring-fuchsia-400', rgb: '232, 121, 249' },
            { id: 'red', name: 'Imperial Red', primary: 'from-red-500 to-rose-600', glow: 'bg-red-500', text: 'text-red-600', accent: 'bg-red-500', ring: 'ring-red-500', rgb: '239, 68, 68' },
        ];

        const AdminPanel = ({ config, setConfig, isOpen, setIsOpen }) => {
            const fileInputRef = useRef(null);

            const handleLogoUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        setConfig({ ...config, hotelLogo: reader.result });
                    };
                    reader.readAsDataURL(file);
                }
            };

            if (!isOpen) {
                return (
                    <button
                        onClick={() => setIsOpen(true)}
                        className="fixed top-4 left-4 z-50 p-3 bg-white border border-slate-200 text-slate-600 rounded-full shadow-lg hover:rotate-90 transition-all duration-500 hover:text-slate-900"
                    >
                        <IconWrapper name="Settings" size={24} />
                    </button>
                );
            }

            return (
                <div className="fixed top-4 left-4 z-50 w-72 bg-white/95 backdrop-blur-xl border border-slate-200 rounded-2xl shadow-2xl p-5 animate-fade-in-right overflow-y-auto max-h-[90vh]">
                    <div className="flex justify-between items-center mb-5">
                        <h2 className="text-sm font-bold text-slate-800 flex items-center gap-2">
                            <IconWrapper name="Settings" size={16} /> Widget Settings
                        </h2>
                        <button onClick={() => setIsOpen(false)} className="text-slate-400 hover:text-slate-600">
                            <IconWrapper name="X" size={18} />
                        </button>
                    </div>

                    <div className="space-y-6">
                        {/* Language Selector */}
                        <div>
                            <span className="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 block flex items-center gap-2">
                                <IconWrapper name="Globe" size={10} /> Language
                            </span>
                            <div className="flex gap-2">
                                {Object.keys(TEXT_VARIATIONS).map(lang => (
                                    <button
                                        key={lang}
                                        onClick={() => setConfig({ ...config, lang, variantId: TEXT_VARIATIONS[lang].variants[0].id })}
                                        className={`flex-1 py-1.5 text-xs font-medium rounded-md transition-all ${config.lang === lang ? 'bg-slate-900 text-white' : 'bg-slate-100 text-slate-600 hover:bg-slate-200'}`}
                                    >
                                        {lang.toUpperCase()}
                                    </button>
                                ))}
                            </div>
                        </div>

                        <div className="h-px bg-slate-100" />

                        {/* Positioning */}
                        <div>
                            <span className="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 block">Position</span>
                            <div className="flex gap-2 mb-3">
                                <button
                                    onClick={() => setConfig({ ...config, position: 'left' })}
                                    className={`flex-1 p-2 rounded-md border flex justify-center ${config.position === 'left' ? 'bg-slate-100 border-slate-300 text-slate-900' : 'border-slate-100 text-slate-400'}`}
                                >
                                    <IconWrapper name="AlignLeft" size={16} />
                                </button>
                                <button
                                    onClick={() => setConfig({ ...config, position: 'center' })}
                                    className={`flex-1 p-2 rounded-md border flex justify-center ${config.position === 'center' ? 'bg-slate-100 border-slate-300 text-slate-900' : 'border-slate-100 text-slate-400'}`}
                                >
                                    <IconWrapper name="AlignCenter" size={16} />
                                </button>
                                <button
                                    onClick={() => setConfig({ ...config, position: 'right' })}
                                    className={`flex-1 p-2 rounded-md border flex justify-center ${config.position === 'right' ? 'bg-slate-100 border-slate-300 text-slate-900' : 'border-slate-100 text-slate-400'}`}
                                >
                                    <IconWrapper name="AlignRight" size={16} />
                                </button>
                            </div>

                            <div className="grid grid-cols-2 gap-3">
                                <div>
                                    <label className="text-[10px] text-slate-400 mb-1 flex items-center gap-1">
                                        <IconWrapper name="MoveHorizontal" size={10} /> Offset X
                                    </label>
                                    <input
                                        type="number"
                                        value={config.offsetX}
                                        onChange={(e) => setConfig({ ...config, offsetX: Number(e.target.value) })}
                                        className="w-full bg-slate-50 border border-slate-200 rounded p-1 text-xs"
                                    />
                                </div>
                                <div>
                                    <label className="text-[10px] text-slate-400 mb-1 flex items-center gap-1">
                                        <IconWrapper name="MoveVertical" size={10} /> Offset Y
                                    </label>
                                    <input
                                        type="number"
                                        value={config.offsetY}
                                        onChange={(e) => setConfig({ ...config, offsetY: Number(e.target.value) })}
                                        className="w-full bg-slate-50 border border-slate-200 rounded p-1 text-xs"
                                    />
                                </div>
                            </div>
                        </div>

                        <div className="h-px bg-slate-100" />

                        {/* Theme */}
                        <div>
                            <span className="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 block">Appearance</span>
                            <div className="p-1 bg-slate-100 rounded-lg flex relative">
                                <button
                                    onClick={() => setConfig({ ...config, themeMode: 'light' })}
                                    className={`flex-1 flex items-center justify-center gap-2 py-1.5 text-xs font-medium rounded-md transition-all z-10 ${config.themeMode === 'light' ? 'bg-white text-slate-900 shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}
                                >
                                    <IconWrapper name="Sun" size={12} /> Light
                                </button>
                                <button
                                    onClick={() => setConfig({ ...config, themeMode: 'dark' })}
                                    className={`flex-1 flex items-center justify-center gap-2 py-1.5 text-xs font-medium rounded-md transition-all z-10 ${config.themeMode === 'dark' ? 'bg-slate-800 text-white shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}
                                >
                                    <IconWrapper name="Moon" size={12} /> Dark
                                </button>
                            </div>
                        </div>

                        {/* Branding */}
                        <div>
                            <span className="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 block">Branding</span>
                            <input
                                type="text"
                                value={config.hotelName}
                                onChange={(e) => setConfig({ ...config, hotelName: e.target.value })}
                                className="w-full bg-slate-50 border border-slate-200 rounded-md text-xs p-2 text-slate-900 outline-none focus:ring-1 focus:ring-slate-300 mb-2"
                                placeholder="Hotel Name"
                            />
                            <div
                                onClick={() => fileInputRef.current?.click()}
                                className="w-full h-12 border-2 border-dashed border-slate-200 rounded-md flex flex-col items-center justify-center cursor-pointer hover:bg-slate-50 transition-all"
                            >
                                {config.hotelLogo ? (
                                    <img src={config.hotelLogo} alt="Logo" className="h-6 object-contain" />
                                ) : (
                                    <span className="text-[10px] text-slate-400 flex items-center gap-1"><IconWrapper name="Upload" size={10} /> Upload Logo</span>
                                )}
                                <input type="file" ref={fileInputRef} className="hidden" accept="image/*" onChange={handleLogoUpload} />
                            </div>
                        </div>

                        {/* Colors */}
                        <div>
                            <span className="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 block">Accent</span>
                            <div className="grid grid-cols-5 gap-2">
                                {COLOR_THEMES.map(theme => (
                                    <button
                                        key={theme.id}
                                        onClick={() => setConfig({ ...config, themeId: theme.id })}
                                        className={`w-8 h-8 rounded-full bg-gradient-to-br ${theme.primary} shadow-sm transition-transform hover:scale-110 ${config.themeId === theme.id ? 'ring-2 ring-offset-2 ring-slate-900 scale-110' : ''}`}
                                    />
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const HotelVoiceAssistant = () => {
            const [config, setConfig] = useState({
                themeMode: 'dark',
                lang: 'ru',
                variantId: 'formal',
                themeId: 'gold',
                hotelName: 'Grand Hotel',
                hotelLogo: null,
                position: 'right',
                offsetX: 0,
                offsetY: 0
            });

            const [isAdminOpen, setIsAdminOpen] = useState(false);
            const [isOpen, setIsOpen] = useState(false);
            const [callState, setCallState] = useState('idle');
            const [activePos, setActivePos] = useState('right');

            useEffect(() => {
                setActivePos(config.position);
                if (config.position === 'center') {
                    setIsOpen(true);
                } else {
                    setIsOpen(false);
                }
            }, [config.position]);

            const activeTheme = COLOR_THEMES.find(t => t.id === config.themeId) || COLOR_THEMES[0];
            const activeText = TEXT_VARIATIONS[config.lang].variants.find(v => v.id === config.variantId) || TEXT_VARIATIONS[config.lang].variants[0];
            const styles = THEME_MODES[config.themeMode];

            const handleStart = () => {
                setCallState('connecting');
                setTimeout(() => setCallState('active'), 2000);
            };

            const handleEnd = () => setCallState('idle');

            const handleDismissCenter = () => {
                setActivePos('right');
                setIsOpen(false);
                setCallState('idle');
            };

            const toggleWidget = () => {
                setIsOpen(!isOpen);
                if (isOpen) setCallState('idle');
            };

            const getPositionStyles = () => {
                const baseBottom = 48 + config.offsetY;
                const baseSide = 32 + config.offsetX;

                let containerStyle = { bottom: `${baseBottom}px`, transition: 'all 0.6s cubic-bezier(0.16, 1, 0.3, 1)' };
                let flexClass = 'flex-row';
                let originClass = 'origin-bottom-right';

                if (activePos === 'right') {
                    containerStyle.right = `${baseSide}px`;
                    containerStyle.left = 'auto';
                    containerStyle.transform = 'none';
                    flexClass = 'flex-row';
                    originClass = 'origin-bottom-right';
                } else if (activePos === 'left') {
                    containerStyle.left = `${baseSide}px`;
                    containerStyle.right = 'auto';
                    containerStyle.transform = 'none';
                    flexClass = 'flex-row-reverse';
                    originClass = 'origin-bottom-left';
                } else if (activePos === 'center') {
                    containerStyle.left = '50%';
                    containerStyle.right = 'auto';
                    containerStyle.transform = `translateX(calc(-50% + ${config.offsetX}px))`;
                    flexClass = 'flex-col items-center';
                    originClass = 'origin-bottom';
                }

                return { containerStyle, flexClass, originClass };
            };

            const { containerStyle, flexClass, originClass } = getPositionStyles();
            const isLauncherHidden = activePos === 'center';

            return (
                <div
                    className="relative min-h-screen w-full font-sans overflow-hidden"
                    style={{
                        backgroundColor: '#f8fafc',
                        backgroundImage: `radial-gradient(#cbd5e1 1.5px, transparent 1.5px)`,
                        backgroundSize: '24px 24px'
                    }}
                >

                    <AdminPanel config={config} setConfig={setConfig} isOpen={isAdminOpen} setIsOpen={setIsAdminOpen} />

                    <div
                        className={`fixed z-40 flex items-end gap-4 transition-all duration-300 ${flexClass}`}
                        style={containerStyle}
                    >
                        {/* WIDGET BUBBLE */}
                        <div
                            style={{ '--pulse-color': activeTheme.rgb }}
                            className={`
                                relative flex items-center
                                w-[280px] p-4 rounded-full
                                transition-all duration-500 ${originClass}
                                ${styles.bg} ${styles.shadow} ${styles.text}
                                ${isOpen
                                    ? 'opacity-100 scale-100'
                                    : 'opacity-0 scale-90 pointer-events-none absolute'
                                }
                                ${callState === 'active' ? `${styles.activeBorderBase} ${activeTheme.ring}` : ''}
                                ${callState === 'active' ? 'animate-[pulse-border_2s_infinite]' : ''}
                            `}
                        >
                            {/* Close Button - Center Mode Only */}
                            {activePos === 'center' && (
                                <button
                                    onClick={handleDismissCenter}
                                    className={`absolute top-1/2 -translate-y-1/2 -right-12 p-2 rounded-full ${styles.bg} ${styles.text} ${styles.border} border shadow-md hover:scale-110 transition-all z-20`}
                                >
                                    <IconWrapper name="X" size={16} />
                                </button>
                            )}

                            {/* LOGO */}
                            <div className={`w-12 h-12 rounded-full ${styles.inputBg} flex items-center justify-center overflow-hidden shrink-0 border ${styles.border} mr-3`}>
                                {config.hotelLogo ? (
                                    <img src={config.hotelLogo} alt="Logo" className="w-full h-full object-cover" />
                                ) : (
                                    <div className={`w-full h-full ${styles.inputBg}`} />
                                )}
                            </div>

                            {/* CONTENT */}
                            <div className="flex-1 min-w-0 flex flex-col items-center justify-center">
                                {callState === 'idle' && (
                                    <button
                                        onClick={handleStart}
                                        className={`
                                            w-full h-10 px-4 rounded-full text-white font-semibold text-sm shadow-md
                                            flex items-center justify-center gap-2 animate-fade-in
                                            bg-gradient-to-r ${activeTheme.primary}
                                            hover:scale-105 transition-transform active:scale-95 whitespace-nowrap
                                        `}
                                    >
                                        <IconWrapper name="Mic" size={18} />
                                        {activeText.button}
                                    </button>
                                )}

                                {callState === 'connecting' && (
                                    <div className="w-full h-10 flex items-center justify-center animate-fade-in">
                                        <span className={`text-sm font-medium ${styles.subtext} animate-pulse truncate`}>
                                            {activeText.connecting}
                                        </span>
                                    </div>
                                )}

                                {callState === 'active' && (
                                    <button
                                        onClick={handleEnd}
                                        className="w-full h-10 rounded-full bg-red-500/10 border border-red-500/20 text-red-500 text-sm font-bold uppercase tracking-wide hover:bg-red-500 hover:text-white transition-colors flex items-center justify-center gap-2 animate-fade-in whitespace-nowrap"
                                    >
                                        <IconWrapper name="PhoneOff" size={16} />
                                        {activeText.end}
                                    </button>
                                )}
                            </div>

                            {/* FOOTER */}
                            <a
                                href="https://hotelmol.com"
                                target="_blank"
                                rel="noopener noreferrer"
                                className="absolute -bottom-7 w-full text-center left-0 text-xs font-medium text-slate-500 opacity-90 hover:opacity-100 hover:text-slate-700 transition-all whitespace-nowrap"
                            >
                                powered by hotelmol.com
                            </a>
                        </div>

                        {/* LAUNCHER & TOOLTIP */}
                        <div className="relative">
                            {!isOpen && activePos !== 'center' && (
                                <div
                                    className={`
                                        absolute top-0 -translate-y-0 whitespace-nowrap py-2 px-4 rounded-xl shadow-lg border border-slate-100 text-sm font-medium animate-fade-in pointer-events-none
                                        bg-white text-slate-900 
                                        ${activePos === 'right' ? 'right-full mr-4 origin-right' : 'left-full ml-4 origin-left'}
                                    `}
                                >
                                    {activeText.tooltip}
                                    <div
                                        className={`absolute top-3 -translate-y-1/2 border-8 border-transparent ${activePos === 'right' ? 'right-[-8px] border-l-white' : 'left-[-8px] border-r-white'} opacity-100`}
                                    />
                                </div>
                            )}

                            <button
                                onClick={toggleWidget}
                                className={`
                                    relative w-16 h-16 rounded-full shrink-0
                                    flex items-center justify-center 
                                    shadow-2xl z-50
                                    transition-all duration-500 cubic-bezier(0.34, 1.56, 0.64, 1)
                                    ${isOpen
                                        ? `${isLauncherHidden ? 'hidden' : ''} ${styles.bg} ${styles.text} rotate-90 border ${styles.border}`
                                        : `bg-gradient-to-br ${activeTheme.primary} text-white rotate-0`
                                    }
                                `}
                            >
                                {isOpen ? <IconWrapper name="X" size={28} /> : (
                                    <div className="relative">
                                        <div className="absolute inset-0 animate-ping opacity-20 bg-white rounded-full"></div>
                                        <div className="relative w-8 h-8 flex items-center justify-center gap-[3px]">
                                            <div className="w-1 h-3 bg-white/80 rounded-full animate-[wave_1.2s_ease-in-out_infinite]" />
                                            <div className="w-1 h-5 bg-white/80 rounded-full animate-[wave_1.2s_ease-in-out_0.2s_infinite]" />
                                            <div className="w-1 h-3 bg-white/80 rounded-full animate-[wave_1.2s_ease-in-out_0.4s_infinite]" />
                                        </div>
                                    </div>
                                )}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<HotelVoiceAssistant />);
    </script>
</body>

</html>